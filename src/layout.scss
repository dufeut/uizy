@use "sass:map";

// ==========================
// Layout CSS Variables
// ==========================
// All values are configurable via CSS custom properties

$layout: (
  system-bar: (
    height: var(--uizy-system-bar-height, 0px),
    layer: var(--uizy-system-bar-layer, 40),
  ),
  header: (
    height: var(--uizy-header-height, 50px),
    layer: var(--uizy-header-layer, 20),
  ),
  footer: (
    height: var(--uizy-footer-height, 50px),
    layer: var(--uizy-footer-layer, 20),
  ),
  left: (
    width: var(--uizy-left-width, 185px),
    width-mini: var(--uizy-left-mini-width, 60px),
    layer: var(--uizy-left-layer, 20),
  ),
  right: (
    width: var(--uizy-right-width, 185px),
    width-mini: var(--uizy-right-mini-width, 60px),
    layer: var(--uizy-right-layer, 20),
  ),
  overlay: (
    color: var(--uizy-overlay-color, black),
    opacity: var(--uizy-overlay-opacity, 0.4),
    layer: var(--uizy-overlay-layer, 10),
  ),
  drawer: (
    speed: var(--uizy-drawer-speed, 0.2s),
    easing: var(--uizy-drawer-easing, cubic-bezier(0.4, 0, 0.2, 1)),
  ),
);

@function layout-get($section, $property) {
  @return map.get(map.get($layout, $section), $property);
}

// ==========================
// Base - All Fixed Position
// ==========================
.uizy-system-bar,
.uizy-header,
.uizy-footer,
.uizy-left,
.uizy-right,
.uizy-main {
  position: fixed;
  box-sizing: border-box;
}

// ==========================
// System Bar
// ==========================
.uizy-system-bar {
  top: 0;
  left: 0;
  right: 0;
  height: layout-get(system-bar, height);
  z-index: layout-get(system-bar, layer);
}

// ==========================
// Header
// ==========================
.uizy-header {
  top: layout-get(system-bar, height);
  height: layout-get(header, height);
  z-index: layout-get(header, layer);
}

// ==========================
// Footer
// ==========================
.uizy-footer {
  bottom: 0;
  height: layout-get(footer, height);
  z-index: layout-get(footer, layer);
}

// ==========================
// Header, Footer, Main share left/right: 0
// ==========================
.uizy-header,
.uizy-footer,
.uizy-main {
  left: 0;
  right: 0;
}

// ==========================
// Main Content
// ==========================
.uizy-main {
  height: 100dvh;
  transition: margin 0.2s linear;
}

// ==========================
// Sidebars & Main share top/bottom: 0
// ==========================
.uizy-main,
.uizy-left,
.uizy-right {
  top: 0;
  bottom: 0;
}

// ==========================
// Left Sidebar
// ==========================
.uizy-left {
  left: 0;
  width: layout-get(left, width);
  z-index: layout-get(left, layer);
}

.uizy-left--mini {
  width: layout-get(left, width-mini);
}

// ==========================
// Right Sidebar
// ==========================
.uizy-right {
  right: 0;
  width: layout-get(right, width);
  z-index: layout-get(right, layer);
}

.uizy-right--mini {
  width: layout-get(right, width-mini);
}

// ==========================
// Drawer Animation
// ==========================
.uizy-drawer {
  transform-style: preserve-3d;
  will-change: transform;
  transition: transform layout-get(drawer, speed) layout-get(drawer, easing);
}

.uizy-drawer--left {
  transform: translateX(-100vw);
}

.uizy-drawer--right {
  transform: translateX(100vw);
}

.uizy-drawer--open {
  transform: translateX(0) !important;
}

// ==========================
// Clip X (horizontal margins)
// ==========================
.uizy-clip-left {
  margin-left: layout-get(left, width);
}

.uizy-clip-right {
  margin-right: layout-get(right, width);
}

.uizy-clip-left-mini {
  margin-left: layout-get(left, width-mini);
  width: calc(#{layout-get(left, width)} - #{layout-get(left, width-mini)});
}

.uizy-clip-right-mini {
  margin-right: layout-get(right, width-mini);
  width: calc(#{layout-get(right, width)} - #{layout-get(right, width-mini)});
}

// Main clip-mini (margin only, no width override)
.uizy-main.uizy-clip-left-mini {
  margin-left: layout-get(left, width-mini);
  width: auto;
}

.uizy-main.uizy-clip-right-mini {
  margin-right: layout-get(right, width-mini);
  width: auto;
}

// ==========================
// Clip Y (vertical positioning)
// ==========================

// System bar only
.uizy-clip-system-bar {
  top: layout-get(system-bar, height);
}

// Full top clip (system-bar + header)
.uizy-clip-top {
  top: calc(#{layout-get(system-bar, height)} + #{layout-get(header, height)});
}

// Bottom clip
.uizy-clip-bottom {
  bottom: layout-get(footer, height);
}

// Main height adjustments
.uizy-main.uizy-clip-system-bar {
  height: calc(100dvh - #{layout-get(system-bar, height)});
}

.uizy-main.uizy-clip-top {
  height: calc(
    100dvh - (#{layout-get(system-bar, height)} + #{layout-get(header, height)})
  );
}

.uizy-main.uizy-clip-bottom {
  height: calc(100dvh - #{layout-get(footer, height)});
}

.uizy-main.uizy-clip-top.uizy-clip-bottom {
  height: calc(
    100dvh -
      (
        #{layout-get(system-bar, height)} + #{layout-get(header, height)} + #{layout-get(
            footer,
            height
          )}
      )
  );
}

.uizy-main.uizy-clip-system-bar.uizy-clip-bottom {
  height: calc(
    100dvh - (#{layout-get(system-bar, height)} + #{layout-get(footer, height)})
  );
}

// ==========================
// Overlay
// ==========================
.uizy-overlay-mask {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: layout-get(overlay, layer);
  background-color: transparent;

  // Clip classes set position for overlay (reset margins from general clip rules)
  &.uizy-clip-system-bar {
    top: layout-get(system-bar, height);
  }
  &.uizy-clip-top {
    top: calc(
      #{layout-get(system-bar, height)} + #{layout-get(header, height)}
    );
  }
  &.uizy-clip-bottom {
    bottom: layout-get(footer, height);
  }
  &.uizy-clip-left {
    left: layout-get(left, width);
    margin-left: 0; // Reset margin from general .uizy-clip-left
  }
  &.uizy-clip-right {
    right: layout-get(right, width);
    margin-right: 0; // Reset margin from general .uizy-clip-right
  }
  &.uizy-clip-left-mini {
    left: layout-get(left, width-mini);
  }
  &.uizy-clip-right-mini {
    right: layout-get(right, width-mini);
  }

  @media (max-width: 1024px) {
    &.uizy-clip-left,
    &.uizy-clip-left-mini {
      left: 0;
    }
    &.uizy-clip-right,
    &.uizy-clip-right-mini {
      right: 0;
    }
  }
}

.uizy-overlay {
  position: absolute;
  inset: 0;
  z-index: layout-get(overlay, layer);
  opacity: layout-get(overlay, opacity);
  background-color: layout-get(overlay, color);
}
